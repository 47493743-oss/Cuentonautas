<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Puzzle Galaxy | Prototipo de app móvil</title>
  <meta name="description" content="Prototipo de app tipo puzzle con mecánicas listas para adaptar a Android y monetizar en Play Store." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f172a;
      --bg-soft: #111a31;
      --bg-card: rgba(15, 23, 42, 0.75);
      --ink: #f8fafc;
      --muted: rgba(248, 250, 252, 0.72);
      --primary: #38bdf8;
      --primary-strong: #0ea5e9;
      --accent: #c084fc;
      --success: #4ade80;
      --warning: #facc15;
      --danger: #f87171;
      --radius: 22px;
      color-scheme: dark;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      min-height: 100%;
      background: radial-gradient(circle at 15% 20%, rgba(56, 189, 248, 0.2), transparent 45%),
        radial-gradient(circle at 80% 12%, rgba(192, 132, 252, 0.26), transparent 50%),
        radial-gradient(circle at 60% 80%, rgba(74, 222, 128, 0.18), transparent 55%),
        linear-gradient(140deg, var(--bg), #020617 70%);
      color: var(--ink);
      font-family: 'Quicksand', system-ui, -apple-system, 'Segoe UI', sans-serif;
      line-height: 1.7;
    }

    header {
      position: sticky;
      top: 0;
      backdrop-filter: blur(12px) saturate(170%);
      background: rgba(15, 23, 42, 0.65);
      border-bottom: 1px solid rgba(148, 163, 184, 0.18);
      z-index: 50;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 24px;
    }

    .bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px 0;
      gap: 16px;
    }

    .brand {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: inherit;
    }

    .logo {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      display: grid;
      place-items: center;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      font-family: 'Fredoka', sans-serif;
      font-weight: 700;
      font-size: 1.4rem;
      color: white;
      box-shadow: 0 18px 38px rgba(14, 165, 233, 0.28);
    }

    nav a {
      text-decoration: none;
      color: var(--muted);
      margin-left: 18px;
      font-weight: 600;
    }

    nav a:hover,
    nav a:focus-visible {
      color: var(--primary);
    }

    main {
      padding: 48px 0 80px;
      display: grid;
      gap: 64px;
    }

    .hero {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 42px;
      align-items: center;
    }

    h1 {
      margin: 0 0 16px;
      font-family: 'Fredoka', sans-serif;
      font-size: clamp(2rem, 4.2vw, 3.2rem);
      line-height: 1.08;
      letter-spacing: -0.01em;
    }

    h2 {
      font-family: 'Fredoka', sans-serif;
      font-size: clamp(1.5rem, 3vw, 2.4rem);
      margin-bottom: 12px;
    }

    p.lead {
      color: var(--muted);
      font-size: 1.1rem;
      margin-bottom: 18px;
    }

    .cta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 20px;
      border-radius: 999px;
      border: 2px solid transparent;
      font-weight: 700;
      color: var(--ink);
      background: var(--primary-strong);
      cursor: pointer;
      text-decoration: none;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .btn:hover,
    .btn:focus-visible {
      transform: translateY(-2px);
      box-shadow: 0 18px 28px rgba(56, 189, 248, 0.28);
    }

    .btn.alt {
      background: transparent;
      border-color: rgba(148, 163, 184, 0.35);
      color: var(--muted);
    }

    .galaxy-card {
      position: relative;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.2), transparent 55%),
        var(--bg-card);
      padding: 26px;
      border-radius: var(--radius);
      box-shadow: 0 26px 42px rgba(2, 6, 23, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.12);
    }

    .floating {
      position: absolute;
      inset: 14px;
      border-radius: var(--radius);
      border: 1px dashed rgba(148, 163, 184, 0.16);
      pointer-events: none;
    }

    .stars {
      position: absolute;
      inset: 0;
      overflow: hidden;
      border-radius: var(--radius);
      pointer-events: none;
    }

    .stars span {
      position: absolute;
      width: 6px;
      height: 6px;
      background: rgba(248, 250, 252, 0.85);
      border-radius: 999px;
      filter: drop-shadow(0 0 8px rgba(148, 163, 184, 0.45));
      animation: twinkle 6s ease-in-out infinite;
    }

    .stars span:nth-child(odd) {
      animation-delay: 2s;
    }

    @keyframes twinkle {
      0%,
      100% {
        opacity: 0.2;
        transform: scale(0.7);
      }

      50% {
        opacity: 1;
        transform: scale(1.15);
      }
    }

    .game-section {
      display: grid;
      gap: 28px;
    }

    .game-layout {
      display: grid;
      gap: 28px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      align-items: start;
    }

    .panel {
      background: rgba(15, 23, 42, 0.78);
      padding: 24px;
      border-radius: var(--radius);
      border: 1px solid rgba(148, 163, 184, 0.12);
      box-shadow: 0 18px 28px rgba(2, 6, 23, 0.45);
    }

    .panel h3 {
      margin-top: 0;
      font-family: 'Fredoka', sans-serif;
      font-size: 1.4rem;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 16px;
      margin: 18px 0;
    }

    .stat {
      background: rgba(15, 23, 42, 0.85);
      border-radius: 18px;
      padding: 16px;
      border: 1px solid rgba(148, 163, 184, 0.1);
    }

    .stat span {
      display: block;
      color: var(--muted);
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .stat strong {
      font-size: 1.4rem;
      font-family: 'Fredoka', sans-serif;
    }

    .board {
      width: min(420px, 90vw);
      aspect-ratio: 1 / 1;
      background: rgba(15, 23, 42, 0.6);
      border-radius: 26px;
      padding: 18px;
      display: grid;
      gap: 12px;
      border: 1px solid rgba(148, 163, 184, 0.18);
      box-shadow: inset 0 0 18px rgba(14, 165, 233, 0.08);
    }

    .tile {
      border: 0;
      border-radius: 18px;
      font-family: 'Fredoka', sans-serif;
      font-size: clamp(1.6rem, 5vw, 2.2rem);
      font-weight: 700;
      color: var(--ink);
      background: linear-gradient(135deg, rgba(56, 189, 248, 0.75), rgba(14, 165, 233, 0.95));
      cursor: pointer;
      display: grid;
      place-items: center;
      transition: transform 0.18s ease, box-shadow 0.18s ease;
    }

    .tile:hover,
    .tile:focus-visible {
      transform: translateY(-4px);
      box-shadow: 0 14px 24px rgba(14, 165, 233, 0.28);
    }

    .tile.empty {
      background: rgba(15, 23, 42, 0.3);
      border: 1px dashed rgba(148, 163, 184, 0.2);
      cursor: default;
      box-shadow: none;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 8px;
    }

    select,
    .btn.small {
      padding: 10px 16px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.68);
      color: var(--ink);
      border: 1px solid rgba(148, 163, 184, 0.26);
      font-weight: 600;
      font-family: inherit;
    }

    .btn.small {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      background: rgba(14, 165, 233, 0.18);
      border-color: rgba(56, 189, 248, 0.48);
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .status {
      margin-top: 18px;
      padding: 16px;
      border-radius: 18px;
      background: rgba(15, 23, 42, 0.68);
      border: 1px solid rgba(148, 163, 184, 0.18);
      min-height: 56px;
    }

    .status strong {
      font-family: 'Fredoka', sans-serif;
      font-size: 1.1rem;
    }

    .monetize {
      display: grid;
      gap: 18px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }

    .monetize article {
      background: rgba(15, 23, 42, 0.72);
      border-radius: var(--radius);
      padding: 20px;
      border: 1px solid rgba(148, 163, 184, 0.14);
      box-shadow: 0 18px 28px rgba(2, 6, 23, 0.42);
    }

    .monetize h3 {
      font-family: 'Fredoka', sans-serif;
      margin-top: 0;
    }

    ul.features {
      list-style: none;
      padding-left: 0;
      display: grid;
      gap: 10px;
      margin: 0;
    }

    ul.features li {
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }

    ul.features li span {
      font-size: 1.2rem;
      margin-top: 2px;
    }

    .roadmap {
      display: grid;
      gap: 14px;
    }

    .roadmap li {
      display: grid;
      gap: 6px;
    }

    #next-steps {
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.12);
      border-radius: var(--radius);
      padding: 36px 32px;
      display: grid;
      gap: 12px;
    }

    .next-steps {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 18px;
    }

    .next-steps li {
      display: grid;
      gap: 6px;
      padding: 18px 20px;
      border-radius: calc(var(--radius) - 6px);
      background: rgba(15, 23, 42, 0.75);
      border: 1px solid rgba(148, 163, 184, 0.16);
    }

    .next-steps strong {
      font-family: 'Fredoka', sans-serif;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .next-steps strong span {
      display: inline-grid;
      place-items: center;
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(56, 189, 248, 0.4), rgba(192, 132, 252, 0.35));
      font-size: 0.95rem;
      color: var(--ink);
      font-weight: 700;
    }

    .next-steps a {
      color: var(--primary);
      font-weight: 600;
    }

    footer {
      margin-top: 64px;
      padding: 32px 0;
      border-top: 1px solid rgba(148, 163, 184, 0.2);
      color: var(--muted);
      font-size: 0.9rem;
      text-align: center;
    }

    @media (max-width: 720px) {
      header {
        position: static;
      }

      nav {
        display: none;
      }

      .board {
        width: 100%;
        padding: 14px;
        gap: 10px;
        border-radius: 20px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap bar">
      <a class="brand" href="#inicio">
        <span class="logo">PG</span>
        <span>Puzzle Galaxy</span>
      </a>
      <nav>
        <a href="#juego">Demo interactiva</a>
        <a href="#monetizacion">Monetización</a>
        <a href="#roadmap">Roadmap</a>
      </nav>
    </div>
  </header>
  <main class="wrap" id="inicio">
    <section class="hero">
      <div>
        <h1>Una app tipo puzzle lista para monetizar en Play Store</h1>
        <p class="lead">Puzzle Galaxy combina niveles deslizables, misiones diarias y tablas de rendimiento. Este prototipo web reproduce la lógica central que luego puedes empaquetar con Capacitor, Flutter o cualquier wrapper híbrido.</p>
        <div class="cta">
          <a class="btn" href="#juego">Probar ahora</a>
          <a class="btn alt" href="#monetizacion">Plan de monetización</a>
        </div>
      </div>
      <div class="galaxy-card" aria-hidden="true">
        <div class="floating"></div>
        <div class="stars">
          <span style="top:12%;left:16%;animation-duration:8s"></span>
          <span style="top:42%;left:68%;animation-duration:6.5s"></span>
          <span style="top:78%;left:32%;animation-duration:7.2s"></span>
          <span style="top:24%;left:80%;animation-duration:5.8s"></span>
          <span style="top:60%;left:12%;animation-duration:9s"></span>
        </div>
        <img src="https://images.unsplash.com/photo-1559757175-0eb30cd612da?auto=format&fit=crop&w=900&q=60" alt="Ilustración espacial" style="width:100%;border-radius:16px;filter:grayscale(0.2) brightness(1.1);mix-blend-mode:screen;">
      </div>
    </section>

    <section class="game-section" id="juego">
      <header>
        <h2>Demo interactiva del puzzle deslizante</h2>
        <p class="lead">Pon a prueba la mecánica principal. El motor genera tableros resolubles, contabiliza movimientos y tiempos, y persiste el mejor récord en el almacenamiento local.</p>
      </header>
      <div class="game-layout">
        <div>
          <div class="board" role="application" aria-label="Tablero del rompecabezas"></div>
          <div class="controls">
            <button class="btn small" data-action="shuffle">🔄 Nuevo desafío</button>
            <button class="btn small" data-action="hint">💡 Movimiento sugerido</button>
            <label>
              <span class="sr-only">Seleccionar dificultad</span>
              <select aria-label="Seleccionar dificultad">
                <option value="3">Fácil 3x3</option>
                <option value="4" selected>Normal 4x4</option>
                <option value="5">Experto 5x5</option>
              </select>
            </label>
          </div>
          <div class="status" role="status" aria-live="polite"></div>
        </div>
        <aside class="panel">
          <h3>Progresión del jugador</h3>
          <div class="stats">
            <div class="stat">
              <span>Movimientos</span>
              <strong id="moves">0</strong>
            </div>
            <div class="stat">
              <span>Tiempo</span>
              <strong id="time">00:00</strong>
            </div>
            <div class="stat">
              <span>Mejor marca</span>
              <strong id="best">--</strong>
            </div>
          </div>
          <p>Integra misiones diarias, modo contrarreloj y power-ups visuales para incrementar la retención. La lógica está encapsulada en JavaScript puro para que puedas migrarla fácilmente a React Native, Flutter o motores como Unity (UI Toolkit).</p>
        </aside>
      </div>
    </section>

    <section id="monetizacion">
      <h2>Estrategia de monetización pensada para Play Store</h2>
      <p class="lead">Construye una economía equilibrada combinando anuncios, compras integradas y retos patrocinados. El diseño se apega a las políticas de Google Play para juegos dirigidos a público general.</p>
      <div class="monetize">
        <article>
          <h3>Ads híbridos y responsables</h3>
          <ul class="features">
            <li><span>🎯</span><div><strong>Interstitials contextuales</strong><br>Se muestran al finalizar partidas de más de 90 segundos y nunca en medio de un movimiento.</div></li>
            <li><span>🎁</span><div><strong>Rewarded Ads</strong><br>Otorgan pistas adicionales o comodines temporales (ej. congelar el temporizador) respetando el consentimiento del usuario.</div></li>
            <li><span>🛡️</span><div><strong>Compliance</strong><br>Implementa el SDK de Consent de Google con segmentación para mayores de 13 años.</div></li>
          </ul>
        </article>
        <article>
          <h3>Compras integradas</h3>
          <ul class="features">
            <li><span>✨</span><div><strong>Season Pass</strong><br>Niveles temáticos y tableros exclusivos cada mes.</div></li>
            <li><span>🚀</span><div><strong>Boosters</strong><br>Acceso instantáneo a pistas y skins premium sin afectar el balance.</div></li>
            <li><span>📊</span><div><strong>Analítica</strong><br>Eventos listos para Firebase Analytics y A/B testing de precios.</div></li>
          </ul>
        </article>
        <article>
          <h3>Retención y comunidad</h3>
          <ul class="features">
            <li><span>🗓️</span><div><strong>Misiones diarias</strong><br>Rachas recompensadas con monedas blandas.</div></li>
            <li><span>🏆</span><div><strong>Tablas globales</strong><br>Sincronizadas con Google Play Games Services.</div></li>
            <li><span>🤝</span><div><strong>Retos patrocinados</strong><br>Marcas crean tableros personalizados con recompensas especiales.</div></li>
          </ul>
        </article>
      </div>
    </section>

    <section id="next-steps">
      <h2>¿Qué hago ahora?</h2>
      <p class="lead">Convierte este prototipo en una app lista para publicar siguiendo estos pasos prácticos.</p>
      <ol class="next-steps">
        <li>
          <strong><span>1</span>Prepara tu proyecto</strong>
          <p>Clona este código en tu IDE favorito y crea un repositorio privado. Define el nombre del paquete de Android y registra la ficha de producto en <a href="https://play.google.com/console/about/" target="_blank" rel="noreferrer">Google Play Console</a>.</p>
        </li>
        <li>
          <strong><span>2</span>Empaqueta el juego</strong>
          <p>Integra el HTML en un contenedor nativo (Flutter WebView, Capacitor o Android WebView). Configura navegación básica, íconos, splash screen y compatibilidad con tablets.</p>
        </li>
        <li>
          <strong><span>3</span>Activa servicios clave</strong>
          <p>Conecta Firebase Analytics, Remote Config y Crashlytics. Implementa el SDK de anuncios de AdMob y las compras in-app con la <a href="https://developer.android.com/google/play/billing" target="_blank" rel="noreferrer">Billing Library</a>.</p>
        </li>
        <li>
          <strong><span>4</span>Lanza y optimiza</strong>
          <p>Sube una versión cerrada para QA, recopila métricas de retención y monetización y haz iteraciones semanales. Prepara campañas de adquisición usando assets del hero y del gameplay.</p>
        </li>
      </ol>
    </section>

    <section id="roadmap">
      <h2>Roadmap sugerido</h2>
      <p class="lead">Sigue estas fases para lanzar y escalar en la Play Store manteniendo KPIs saludables.</p>
      <ol class="roadmap">
        <li>
          <strong>Fase 1 · MVP jugable (Semana 1-2)</strong>
          <p>Integrar este puzzle en un contenedor Android (WebView, Flutter WebView o Capacitor). Añadir autenticación con Google Play Games y analítica básica.</p>
        </li>
        <li>
          <strong>Fase 2 · Monetización básica (Semana 3-5)</strong>
          <p>Implementar anuncios intersticiales y rewarded con AdMob. Configurar compras in-app para pistas ilimitadas.</p>
        </li>
        <li>
          <strong>Fase 3 · LiveOps (Semana 6+)</strong>
          <p>Lanzar eventos temporales, tablas globales, notificaciones push y campañas de UA optimizadas.</p>
        </li>
      </ol>
    </section>
  </main>
  <footer>
    Puzzle Galaxy · Prototipo UI/UX para Play Store · Construido con HTML, CSS y JavaScript puro.
  </footer>

  <script>
    const boardEl = document.querySelector('.board');
    const movesEl = document.getElementById('moves');
    const timeEl = document.getElementById('time');
    const bestEl = document.getElementById('best');
    const statusEl = document.querySelector('.status');
    const difficultySelect = document.querySelector('select');
    const bestKey = 'puzzle-galaxy-best';

    let size = parseInt(difficultySelect.value, 10);
    let tiles = [];
    let emptyIndex = size * size - 1;
    let moves = 0;
    let time = 0;
    let timerId = null;

    function coords(index) {
      return { row: Math.floor(index / size), col: index % size };
    }

    function getNeighbors(index) {
      const { row, col } = coords(index);
      const neighbors = [];
      if (row > 0) neighbors.push(index - size);
      if (row < size - 1) neighbors.push(index + size);
      if (col > 0) neighbors.push(index - 1);
      if (col < size - 1) neighbors.push(index + 1);
      return neighbors;
    }

    function createSolvedArray() {
      const arr = [];
      for (let i = 1; i < size * size; i += 1) {
        arr.push(i);
      }
      arr.push(0);
      return arr;
    }

    function shuffleArray() {
      const arr = createSolvedArray();
      let empty = arr.length - 1;
      const iterations = size * size * 50;
      for (let i = 0; i < iterations; i += 1) {
        const neighbors = getNeighbors(empty);
        const pick = neighbors[Math.floor(Math.random() * neighbors.length)];
        arr[empty] = arr[pick];
        arr[pick] = 0;
        empty = pick;
      }
      return { arr, empty };
    }

    function render() {
      boardEl.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
      boardEl.innerHTML = '';
      tiles.forEach((value, index) => {
        const tile = document.createElement('button');
        tile.type = 'button';
        tile.className = value === 0 ? 'tile empty' : 'tile';
        tile.dataset.index = index;
        tile.setAttribute('aria-label', value === 0 ? 'Espacio vacío' : `Ficha ${value}`);
        if (value !== 0) {
          tile.textContent = value;
        }
        boardEl.appendChild(tile);
      });
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
      const secs = (seconds % 60).toString().padStart(2, '0');
      return `${mins}:${secs}`;
    }

    function updateStats() {
      movesEl.textContent = moves;
      timeEl.textContent = formatTime(time);
      const record = getBestTime(size);
      bestEl.textContent = record ? `${record.moves} mov · ${formatTime(record.time)}` : '--';
    }

    function startTimer() {
      clearInterval(timerId);
      timerId = setInterval(() => {
        time += 1;
        timeEl.textContent = formatTime(time);
      }, 1000);
    }

    function stopTimer() {
      clearInterval(timerId);
      timerId = null;
    }

    function setStatus(message, tone = 'info') {
      const colors = {
        info: 'var(--muted)',
        success: 'var(--success)',
        warning: 'var(--warning)',
        danger: 'var(--danger)'
      };
      statusEl.innerHTML = `<strong style="color:${colors[tone] || colors.info}">${message}</strong>`;
    }

    function isSolved() {
      for (let i = 0; i < tiles.length - 1; i += 1) {
        if (tiles[i] !== i + 1) {
          return false;
        }
      }
      return tiles[tiles.length - 1] === 0;
    }

    function saveBestTime(record) {
      const stored = JSON.parse(localStorage.getItem(bestKey) || '{}');
      stored[size] = record;
      localStorage.setItem(bestKey, JSON.stringify(stored));
    }

    function getBestTime(currentSize) {
      const stored = JSON.parse(localStorage.getItem(bestKey) || '{}');
      return stored[currentSize];
    }

    function maybeUpdateBest() {
      const record = getBestTime(size);
      if (!record || time < record.time || (time === record.time && moves < record.moves)) {
        saveBestTime({ time, moves });
        setStatus('¡Nuevo récord galáctico! 🎉', 'success');
      } else {
        setStatus('Puzzle completado. ¡Sigue escalando posiciones! 🚀', 'success');
      }
      updateStats();
    }

    function resetGame(newSize = size) {
      size = newSize;
      const { arr, empty } = shuffleArray();
      tiles = arr;
      emptyIndex = empty;
      moves = 0;
      time = 0;
      stopTimer();
      startTimer();
      render();
      updateStats();
      setStatus('Tablero listo. Desliza las fichas para ordenar de menor a mayor.');
    }

    function swap(index) {
      [tiles[emptyIndex], tiles[index]] = [tiles[index], tiles[emptyIndex]];
      emptyIndex = index;
    }

    function moveTile(index) {
      if (tiles[index] === 0) return;
      if (!getNeighbors(index).includes(emptyIndex)) {
        setStatus('Solo puedes mover fichas junto al espacio vacío.', 'warning');
        return;
      }
      swap(index);
      moves += 1;
      render();
      updateStats();
      if (isSolved()) {
        stopTimer();
        maybeUpdateBest();
      }
    }

    function hint() {
      const neighbors = getNeighbors(emptyIndex).filter((i) => tiles[i] !== 0);
      const target = neighbors[Math.floor(Math.random() * neighbors.length)];
      const value = tiles[target];
      setStatus(`Prueba mover la ficha ${value} hacia el espacio libre.`, 'info');
    }

    boardEl.addEventListener('click', (event) => {
      const tile = event.target.closest('.tile');
      if (!tile) return;
      const index = Number(tile.dataset.index);
      moveTile(index);
    });

    document.body.addEventListener('keydown', (event) => {
      if (!['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)) return;
      event.preventDefault();
      let target;
      if (event.key === 'ArrowUp') target = emptyIndex + size;
      if (event.key === 'ArrowDown') target = emptyIndex - size;
      if (event.key === 'ArrowLeft') target = emptyIndex + 1;
      if (event.key === 'ArrowRight') target = emptyIndex - 1;
      if (target != null && target >= 0 && target < tiles.length) {
        if (getNeighbors(target).includes(emptyIndex)) {
          moveTile(target);
        }
      }
    });

    document.querySelector('[data-action="shuffle"]').addEventListener('click', () => {
      resetGame(size);
    });

    document.querySelector('[data-action="hint"]').addEventListener('click', () => {
      hint();
    });

    difficultySelect.addEventListener('change', (event) => {
      const newSize = parseInt(event.target.value, 10);
      resetGame(newSize);
    });

    resetGame(size);
  </script>
</body>
</html>
